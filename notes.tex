pip install "apache-airflow[s3, postgres]"

modify dag folder to point to you project.

# run airflow
airflow webserver
airflow scheduler


python 3.5
pip install pyspark 
conda install pandas 
pip install paramiko
pip install sshtunnel

create_table = PostgresOperator(
    task_id="create_tables",
    postgres_conn_id="redshift",
    dag=dag,
    sql=("""
    BEGIN;
    DROP TABLE IF EXISTS public.papers; 
    CREATE TABLE public.papers (
    abstract varchar(256) NOT NULL,
    authors varchar(256) NOT NULL,
    authors_parsed varchar(256) NOT NULL,
    categories varchar(256) NOT NULL,
    comments varchar(256) NOT NULL,
    doi varchar(256) NOT NULL,
    id varchar(20) NOT NULL,
    journal_ref varchar(256) NOT NULL,
    license varchar(256) NOT NULL,
    report_no varchar(256) NOT NULL,
    submitter varchar(256) NOT NULL,
    title varchar(256) NOT NULL,
    update_date varchar(256) NOT NULL,
    versions varchar(256) NOT NULL,
    CONSTRAINT papers_pk PRIMARY KEY (id)
    ) diststyle even;
    DROP TABLE IF EXISTS public.authors; 
    CREATE TABLE public.authors (
        pk_author INT IDENTITY(0,1) PRIMARY KEY,
        id varchar(20) NOT NULL,
        author varchar(256) NOT NULL
    ) diststyle all;
    DROP TABLE IF EXISTS public.abstracts;
    CREATE TABLE public.abstracts (
        id varchar(20) NOT NULL PRIMARY KEY,
        abstract varchar(256) NOT NULL
    ) diststyle auto;
    DROP TABLE IF EXISTS public.categories;
    CREATE TABLE public.categories (
        pk_categories INT IDENTITY(0,1) PRIMARY KEY,
        id varchar(20) NOT NULL,
        category varchar(256) NOT NULL
    ) diststyle all;
    DROP TABLE IF EXISTS public.versions;
    CREATE TABLE public.versions (
        pk_versions INT IDENTITY(0,1) PRIMARY KEY,
        id varchar(20) NOT NULL,
        version varchar(10) NOT NULL,
        month varchar(10) NOT NULL,
        year INT NOT NULL
    ) diststyle all;
    DROP TABLE IF EXISTS public.titles;
    CREATE TABLE public.titles (
        id varchar(20) NOT NULL PRIMARY KEY,
        title varchar(256) NOT NULL
    ) diststyle all;
    COMMIT;
    """),